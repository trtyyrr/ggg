<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8"><title>Valae è‡ªåŠ¨åŒ–å·¥å‚</title>
    <style>
        body { background: #000; color: #0f0; font-family: monospace; padding: 20px; }
        .box { border: 1px solid #0f0; padding: 20px; max-width: 600px; margin: 0 auto; }
        textarea { width: 100%; height: 100px; background: #111; color: #0f0; border: 1px solid #0f0; margin: 10px 0; }
        button { background: #0f0; color: #000; border: none; padding: 10px 20px; cursor: pointer; font-weight: bold; width: 100%; }
        #log { margin-top: 20px; font-size: 0.8em; color: #888; }
    </style>
</head>
<body>
    <div class="box">
        <h3>ğŸš€ ä¸€å¥è¯å†™ä»£ç å¹¶å­˜å…¥ Git</h3>
        <textarea id="prompt" placeholder="ä¾‹å¦‚ï¼šå¸®æˆ‘å†™ä¸€ä¸ªçŒœæ•°å­—æ¸¸æˆçš„ Python è„šæœ¬"></textarea>
        <button onclick="startFactory()">å¼€å§‹ç”Ÿäº§å¹¶æ¨é€</button>
        <div id="log">ç­‰å¾…æŒ‡ä»¤...</div>
    </div>

    <script>
        // ğŸ”‘ å¡«å…¥ä½ çš„ä¸‰ä¸ªæ ¸å¿ƒä¿¡æ¯
        const DS_KEY = ""; 
        const GH_TOKEN = ""; 
        const REPO = "trtyyrr/ggg"; // ä¾‹å¦‚: rty13840/Valae

        async function startFactory() {
            const prompt = document.getElementById('prompt').value;
            const log = document.getElementById('log');
            if(!prompt) return;

            log.innerText = "æ­£åœ¨è®© AI å†™ä»£ç ...";
            
            // 1. è®© AI ç”Ÿæˆä»£ç 
            const aiRes = await fetch('https://api.deepseek.com/chat/completions', {
                method: 'POST',
                headers: {'Content-Type': 'application/json', 'Authorization': `Bearer ${DS_KEY}`},
                body: JSON.stringify({
                    model: "deepseek-chat",
                    messages: [{role: "user", content: prompt + "ã€‚è¯·ç›´æ¥ç»™å‡ºä»£ç å†…å®¹ï¼Œä¸è¦è§£é‡Šï¼Œä¸è¦å¸¦ markdown ä»£ç å—ç¬¦å·ã€‚"}]
                })
            });
            const aiData = await aiRes.json();
            const code = aiData.choices[0].message.content;

            // 2. å°†ä»£ç å­˜å…¥ GitHub (é»˜è®¤å­˜ä¸º output.pyï¼Œä½ ä¹Ÿå¯ä»¥æ”¹æˆåˆ«çš„)
            log.innerText = "AI å®Œå·¥ï¼Œæ­£åœ¨æ¨é€åˆ° GitHub...";
            const fileName = "output.py";
            
            // è·å–æ–‡ä»¶çš„ SHA (å¦‚æœæ–‡ä»¶å·²å­˜åœ¨éœ€è¦è¿™ä¸€æ­¥ï¼Œä¸ºäº†ç®€å•ï¼Œæˆ‘ä»¬å‡è®¾æ˜¯æ–°æ–‡ä»¶)
            const ghUrl = `https://api.github.com/repos/${REPO}/contents/${fileName}`;
            
            const ghRes = await fetch(ghUrl, {
                method: 'PUT',
                headers: {
                    'Authorization': `token ${GH_TOKEN}`,
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    message: `AI generated ${fileName}`,
                    content: btoa(unescape(encodeURIComponent(code))) // å°†ä»£ç è½¬ä¸º Base64
                })
            });

            if(ghRes.ok) {
                log.innerText = `âœ… æˆåŠŸï¼æ–‡ä»¶å·²å­˜å…¥ä»“åº“ï¼š${fileName}`;
            } else {
                log.innerText = "âŒ æ¨é€å¤±è´¥ï¼Œè¯·æ£€æŸ¥ Token æƒé™æˆ–ä»“åº“è·¯å¾„";
            }
        }
    </script>
</body>
</html>